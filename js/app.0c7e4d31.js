(function(e){function t(t){for(var a,i,s=t[0],c=t[1],l=t[2],_=0,h=[];_<s.length;_++)i=s[_],Object.prototype.hasOwnProperty.call(o,i)&&o[i]&&h.push(o[i][0]),o[i]=0;for(a in c)Object.prototype.hasOwnProperty.call(c,a)&&(e[a]=c[a]);u&&u(t);while(h.length)h.shift()();return r.push.apply(r,l||[]),n()}function n(){for(var e,t=0;t<r.length;t++){for(var n=r[t],a=!0,s=1;s<n.length;s++){var c=n[s];0!==o[c]&&(a=!1)}a&&(r.splice(t--,1),e=i(i.s=n[0]))}return e}var a={},o={app:0},r=[];function i(t){if(a[t])return a[t].exports;var n=a[t]={i:t,l:!1,exports:{}};return e[t].call(n.exports,n,n.exports,i),n.l=!0,n.exports}i.m=e,i.c=a,i.d=function(e,t,n){i.o(e,t)||Object.defineProperty(e,t,{enumerable:!0,get:n})},i.r=function(e){"undefined"!==typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},i.t=function(e,t){if(1&t&&(e=i(e)),8&t)return e;if(4&t&&"object"===typeof e&&e&&e.__esModule)return e;var n=Object.create(null);if(i.r(n),Object.defineProperty(n,"default",{enumerable:!0,value:e}),2&t&&"string"!=typeof e)for(var a in e)i.d(n,a,function(t){return e[t]}.bind(null,a));return n},i.n=function(e){var t=e&&e.__esModule?function(){return e["default"]}:function(){return e};return i.d(t,"a",t),t},i.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},i.p="/";var s=window["webpackJsonp"]=window["webpackJsonp"]||[],c=s.push.bind(s);s.push=t,s=s.slice();for(var l=0;l<s.length;l++)t(s[l]);var u=c;r.push([0,"chunk-vendors"]),n()})({0:function(e,t,n){e.exports=n("56d7")},"034f":function(e,t,n){"use strict";var a=n("85ec"),o=n.n(a);o.a},"0487":function(e,t,n){},"1dea":function(e,t,n){"use strict";var a=n("6d3e"),o=n.n(a);o.a},"56d7":function(e,t,n){"use strict";n.r(t);n("e260"),n("e6cf"),n("cca6"),n("a79d");var a=n("2b0e"),o=function(){var e=this,t=this,n=t.$createElement,a=t._self._c||n;return a("div",[a("div",{class:["content-container",t.sidebar_shown_on_pc_mode?"":"side-hidden-screen"]},[a("ContentView",{attrs:{base_name:t.contentAlbumName,album_friendly_name:t.contentFriendlyName,sidebar_shown_pc:t.sidebar_shown_on_pc_mode},on:{"should-show-sidebar":function(e,n){return"mobile"===n?t.sidebar_shown_on_mobile_mode=e:t.sidebar_shown_on_pc_mode=e},"preview-photo":function(e,n,a,o,r){return t.previewPhoto(e,n,a,o,r)}}})],1),a("div",{directives:[{name:"show",rawName:"v-show",value:t.sidebar_shown_on_mobile_mode,expression:"sidebar_shown_on_mobile_mode"}],staticClass:"sidebar-mobile-mask",on:{click:function(e){t.sidebar_shown_on_mobile_mode=!1}}}),a("div",{class:["sidebar-container",t.sidebar_shown_on_pc_mode?"":"side-hidden-screen",t.sidebar_shown_on_mobile_mode?"sidebar-mobile-shown":""]},[a("Sidebar",{ref:"sidebar",on:{"switch-album":function(t,n){e.contentAlbumName=t,e.contentFriendlyName=n},"should-show-sidebar":function(e,n){return"mobile"===n?t.sidebar_shown_on_mobile_mode=e:t.sidebar_shown_on_pc_mode=e}}})],1),a("div",{directives:[{name:"show",rawName:"v-show",value:t.preview_shown,expression:"preview_shown"}],staticClass:"preview-container"},[a("Preview",{attrs:{current_photo_filename:t.preview_filename,image_list:t.preview_imagelist,index:t.preview_index,current_album_name:t.preview_album_name,catalog_name:t.contentFriendlyName,current_photo:t.preview_current_obj},on:{"hide-preview":function(e){t.preview_shown=!1}}})],1),a("div",{directives:[{name:"show",rawName:"v-show",value:t.password_input_shown,expression:"password_input_shown"}],staticClass:"password-container"},[a("PasswordInput",{ref:"password_input",on:{"submit-password":function(e){return t.checkPassword(e)}}})],1)])},r=[],i=(n("96cf"),n("1da1")),s=function(){var e=this,t=this,n=t.$createElement,a=t._self._c||n;return a("div",{staticStyle:{"padding-left":"10px","padding-right":"10px",height:"100%","overflow-y":"auto"},on:{scroll:t.handleScroll}},[a("div",{class:["navbar",t.shouldShowSemiTransparentNavBar?"":"large"]},[a("div",{staticClass:"nav-title"},[t._v(" 照片 ")]),a("div",{staticClass:"left-button-group"},[a("a",{staticClass:"hidden-btn",attrs:{href:"javascript:void(0)"},on:{click:function(){e.raise_event_show_sidebar(!1,"mobile"),e.raise_event_show_sidebar(!1,"pc")}}},[a("IconBase",{attrs:{"icon-color":"#5555ff"}},[a("IconSideBar")],1)],1)]),a("div",{staticClass:"right-button-group"},[a("a",{attrs:{href:"javascript:void(0)"},on:{click:function(e){return t.logout()}}},[a("IconBase",{attrs:{"icon-color":"#5555ff",height:"21"}},[a("IconExit")],1)],1)])]),a("div",{staticClass:"title1 navtitle",style:{marginTop:"50px",opacity:1-t.shouldShowSemiTransparentNavBar}},[t._v(" 照片 ")]),a("div",{staticClass:"listview normal-menu-ui",staticStyle:{"margin-top":"5px"}},[a("a",{class:t.get_css_class_list_item("/all"),attrs:{href:"javascript:void(0)"},on:{click:function(e){return t.on_switch_album("/all","图库")}}},[a("span",[t._v("图库")])]),a("a",{class:t.get_css_class_list_item("/recent"),attrs:{href:"javascript:void(0)"},on:{click:function(e){return t.on_switch_album("/recent","最近项目")}}},[a("span",[t._v("最近项目")])]),a("a",{class:t.get_css_class_list_item("/fav"),attrs:{href:"javascript:void(0)"},on:{click:function(e){return t.on_switch_album("/fav","个人收藏")}}},[a("span",[t._v("个人收藏")])])]),a("div",{staticClass:"title2"},[t._v(" 我的相簿 ")]),a("div",{staticClass:"listview"},t._l(t.album_list,(function(e){return a("a",{key:e.name,class:["album-prev",t.get_css_class_list_item(e.name)],attrs:{href:"javascript:void(0)"},on:{click:function(n){return t.on_switch_album(e.name,e.friendly_name)}}},[a("div",{staticStyle:{position:"relative"}},[a("div",{staticClass:"list_img",style:{backgroundImage:""===e.preview?"":"url('/api/album-cache/"+e.name+"/"+e.preview+"')"}}),a("span",{staticStyle:{"margin-left":"27px"}},[t._v(t._s(e.friendly_name))])])])})),0)])},c=[];n("f33e"),n("bfe0"),n("9b91"),n("8e9e"),n("99af"),n("d3b7");function l(e){var t=".";return window.enabled_password&&(t=window.miyuki_password),new Promise((function(n,a){fetch("/api/".concat(t,"/").concat(e,".json")).then((function(e){if(e.ok)return n(e.json());throw new Error("Network response was not ok: url")})).catch((function(t){console.error("HTTP Request: /GET "+e+" [FAILED]",t),a(t)}))}))}function u(e){return new Promise((function(t,n){fetch("/api/".concat(e,".json")).then((function(e){if(e.ok)return t(e.json());throw new Error("Network response was not ok: url")})).catch((function(t){console.error("HTTP Request: /GET "+e+" [FAILED]",t),n(t)}))}))}var _={get_secured_json:l,get_json:u},h=function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("svg",{attrs:{xmlns:"http://www.w3.org/2000/svg",width:e.width,height:e.height}},[n("g",{attrs:{fill:e.iconColor}},[e._t("default")],2)])},d=[],p=(n("a9e3"),{name:"IconBase.vue",props:{width:{type:[Number,String],default:25},height:{type:[Number,String],default:18},iconColor:{type:String,default:"currentColor"}}}),m=p,f=(n("daa8"),n("2877")),v=Object(f["a"])(m,h,d,!1,null,"5c0a3205",null),w=v.exports,b=function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("path",{attrs:{d:"M3.06641 17.998L19.9609 17.998C22.0117 17.998 23.0273 16.9824 23.0273 14.9707L23.0273 3.04688C23.0273 1.03516 22.0117 0.0195312 19.9609 0.0195312L3.06641 0.0195312C1.02539 0.0195312 0 1.02539 0 3.04688L0 14.9707C0 16.9922 1.02539 17.998 3.06641 17.998ZM3.08594 16.4258C2.10938 16.4258 1.57227 15.9082 1.57227 14.8926L1.57227 3.125C1.57227 2.10938 2.10938 1.5918 3.08594 1.5918L19.9414 1.5918C20.9082 1.5918 21.4551 2.10938 21.4551 3.125L21.4551 14.8926C21.4551 15.9082 20.9082 16.4258 19.9414 16.4258ZM7.44141 16.7285L8.97461 16.7285L8.97461 1.29883L7.44141 1.29883ZM5.56641 5.21484C5.85938 5.21484 6.12305 4.95117 6.12305 4.66797C6.12305 4.375 5.85938 4.12109 5.56641 4.12109L3.4668 4.12109C3.17383 4.12109 2.91992 4.375 2.91992 4.66797C2.91992 4.95117 3.17383 5.21484 3.4668 5.21484ZM5.56641 7.74414C5.85938 7.74414 6.12305 7.48047 6.12305 7.1875C6.12305 6.89453 5.85938 6.65039 5.56641 6.65039L3.4668 6.65039C3.17383 6.65039 2.91992 6.89453 2.91992 7.1875C2.91992 7.48047 3.17383 7.74414 3.4668 7.74414ZM5.56641 10.2637C5.85938 10.2637 6.12305 10.0195 6.12305 9.72656C6.12305 9.43359 5.85938 9.17969 5.56641 9.17969L3.4668 9.17969C3.17383 9.17969 2.91992 9.43359 2.91992 9.72656C2.91992 10.0195 3.17383 10.2637 3.4668 10.2637Z","fill-opacity":"0.85"}})},g=[],C={},y=Object(f["a"])(C,b,g,!1,null,null,null),x=y.exports,k=function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("g",[n("path",{attrs:{d:"M3.02734 20.9375L13.3984 20.9375C15.4199 20.9375 16.4258 19.9219 16.4258 17.8809L16.4258 3.06641C16.4258 1.03516 15.4199 0 13.3984 0L3.02734 0C1.01562 0 0 1.03516 0 3.06641L0 17.8809C0 19.9219 1.01562 20.9375 3.02734 20.9375ZM1.57227 17.8516L1.57227 3.0957C1.57227 2.11914 2.09961 1.57227 3.11523 1.57227L13.3203 1.57227C14.3359 1.57227 14.8535 2.11914 14.8535 3.0957L14.8535 17.8516C14.8535 18.8281 14.3359 19.3652 13.3203 19.3652L3.11523 19.3652C2.09961 19.3652 1.57227 18.8281 1.57227 17.8516Z","fill-opacity":"0.85"}}),n("path",{attrs:{d:"M9.04297 13.1348L21.9141 13.1348C23.3594 13.1348 24.5605 11.9238 24.5605 10.4688C24.5605 9.01367 23.3594 7.80273 21.9141 7.80273L9.04297 7.80273C7.58789 7.80273 6.39648 9.01367 6.39648 10.4688C6.39648 11.9238 7.58789 13.1348 9.04297 13.1348Z",fill:"aliceblue"}}),n("path",{attrs:{d:"M9.04297 11.2402L19.0723 11.2402L20.5273 11.1816L19.8438 11.8457L18.2617 13.3203C18.1055 13.457 18.0273 13.6621 18.0273 13.8477C18.0273 14.2578 18.3203 14.5605 18.7109 14.5605C18.9258 14.5605 19.082 14.4824 19.2285 14.3359L22.4121 11.0352C22.6074 10.8398 22.6758 10.6641 22.6758 10.4688C22.6758 10.2637 22.6074 10.0977 22.4121 9.90234L19.2285 6.60156C19.082 6.45508 18.9258 6.36719 18.7109 6.36719C18.3203 6.36719 18.0273 6.66016 18.0273 7.07031C18.0273 7.26562 18.1055 7.4707 18.2617 7.60742L19.8438 9.0918L20.5371 9.75586L19.0723 9.6875L9.04297 9.6875C8.63281 9.6875 8.28125 10.0488 8.28125 10.4688C8.28125 10.8887 8.63281 11.2402 9.04297 11.2402Z","fill-opacity":"0.85"}})])},S=[],j={},L=Object(f["a"])(j,k,S,!1,null,null,null),I=L.exports,N={name:"Sidebar",components:{IconSideBar:x,IconBase:w,IconExit:I},data:function(){return{album_list:[],selected_album_name:"/all",shouldShowSemiTransparentNavBar:!1}},methods:{raise_event_show_sidebar:function(e,t){this.$emit("should-show-sidebar",e,t)},on_switch_album:function(e,t){this.$emit("switch-album",e,t),this.selected_album_name=e,window.innerWidth<=1200&&this.raise_event_show_sidebar(!1,"mobile")},get_css_class_list_item:function(e){return e===this.selected_album_name?"selected":""},handleScroll:function(e){console.log(e.srcElement.scrollTop),e.srcElement.scrollTop>=30?this.shouldShowSemiTransparentNavBar=!0:(console.log("ttt"),this.shouldShowSemiTransparentNavBar=!1)},getAlbumList:function(){var e=this;return Object(i["a"])(regeneratorRuntime.mark((function t(){return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return t.next=2,_.get_secured_json("get-album");case 2:e.album_list=t.sent;case 3:case"end":return t.stop()}}),t)})))()},logout:function(){localStorage.removeItem("password"),location.reload()}}},E=N,P=Object(f["a"])(E,s,c,!1,null,"7d841d44",null),O=P.exports,F=function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("div",{staticStyle:{height:"100%","overflow-y":"auto"},on:{scroll:e.handleScroll}},[n("div",{staticClass:"cnav"},[n("div",{class:["title","left",e.sidebar_shown_pc?"":"sidebar-hidden"]},[n("span",{staticClass:"title-text"},[e._v(e._s(e.album_friendly_name))])]),n("div",{staticClass:"title right"},[n("span",{staticStyle:{color:"#eee","margin-right":"10px"}},[e._v(e._s(e.photo_count)+"张图片")]),n("button",{on:{click:function(t){e.menu_more_is_shown=!e.menu_more_is_shown}}},[e._v("...")]),n("div",{directives:[{name:"show",rawName:"v-show",value:e.menu_more_is_shown,expression:"menu_more_is_shown"}],staticClass:"context-menu-mask",on:{click:function(t){e.menu_more_is_shown=!1}}}),n("div",{directives:[{name:"show",rawName:"v-show",value:e.menu_more_is_shown,expression:"menu_more_is_shown"}],class:["context-menu",e.menu_more_is_shown?"shown":"hidden"],staticStyle:{top:"56px",right:"20px"}},[n("a",{attrs:{href:"javascript:void(0)","aria-disabled":e.current_zoom_scale>=2},on:{click:function(t){e.current_zoom_scale<2&&(e.current_zoom_scale++,e.menu_more_is_shown=!1)}}},[e._v("放大")]),n("a",{attrs:{href:"javascript:void(0)","aria-disabled":e.current_zoom_scale<=-6},on:{click:function(t){e.current_zoom_scale>-6&&(e.current_zoom_scale--,e.menu_more_is_shown=!1)}}},[e._v("缩小")]),n("a",{attrs:{href:"javascript:void(0)","aria-disabled":0==e.current_zoom_scale},on:{click:function(t){0!=e.current_zoom_scale&&(e.current_zoom_scale=0,e.menu_more_is_shown=!1)}}},[e._v("默认缩放 (当前："+e._s(e.current_zoom_scale)+")")]),n("hr"),n("a",{attrs:{href:"javascript:void(0)","aria-disabled":"true"}},[e._v("分享...")]),n("hr",{directives:[{name:"show",rawName:"v-show",value:"/fav"===e.base_name,expression:"base_name === '/fav'"}]}),n("a",{directives:[{name:"show",rawName:"v-show",value:"/fav"===e.base_name,expression:"base_name === '/fav'"}],attrs:{href:"javascript:void(0)","aria-disabled":"true"}},[e._v("导出个人收藏")]),n("a",{directives:[{name:"show",rawName:"v-show",value:"/fav"===e.base_name,expression:"base_name === '/fav'"}],attrs:{href:"javascript:void(0)","aria-disabled":"true"}},[e._v("导入个人收藏")])])]),n("div",{staticClass:"back left",staticStyle:{"line-height":"45px",left:"18px",top:"0"},on:{click:function(t){return e.raise_event_show_sidebar(!0,"mobile")}}},[n("i",{staticClass:"larrow",staticStyle:{"border-color":"white"}}),n("span",{staticClass:"backtext"},[e._v("照片")])]),n("div",{class:["back","left","sidebar-hidden-left",e.sidebar_shown_pc?"":"sidebar-hidden"],staticStyle:{"line-height":"45px",left:"18px",top:"0"},on:{click:function(t){return e.raise_event_show_sidebar(!0,"pc")}}},[n("span",{staticClass:"backtext"},[n("IconBase",{attrs:{"icon-color":"white"}},[n("IconSideBar")],1)],1)])]),n("div",e._l(e.photo_list,(function(t,a){return n("div",{key:a,class:["photo","box","scale-ratio-ratio-"+e.current_zoom_scale],style:{backgroundImage:"url('"+e.get_thumbnail_image(t.al,t.name)+"')",backgroundPosition:e.get_thumbnail_image_backgrouod_pos(t)},attrs:{"photo-name":t.name}},[n("div",{staticClass:"photo-mask",staticStyle:{position:"absolute",left:"0",top:"0",width:"100%",height:"100%"},on:{click:function(n){return e.raise_event_show_preview(t.name,e.photo_list,a,t.al,t)}}}),n("div",{staticClass:"fav-btn",style:{position:"absolute",left:"20px",bottom:"20px",display:t.fav?"block":""},on:{click:function(n){return e.switchFavState(t)}}},[t.fav?n("IconBase",{attrs:{"icon-color":"white"}},[n("IconHeartFilled")],1):n("IconBase",{attrs:{"icon-color":"white"}},[n("IconHeart")],1)],1)])})),0)])},B=[],$=(n("d81d"),n("13d5"),n("b0c0"),n("2ca0"),n("2909")),z=(n("eacf"),n("6c84"),n("7f5e"),function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("path",{attrs:{d:"M0 6.49414C0 10.6543 3.48633 14.7461 8.99414 18.2617C9.19922 18.3887 9.49219 18.5254 9.69727 18.5254C9.90234 18.5254 10.1953 18.3887 10.4102 18.2617C15.9082 14.7461 19.3945 10.6543 19.3945 6.49414C19.3945 3.03711 17.0215 0.595703 13.8574 0.595703C12.0508 0.595703 10.5859 1.45508 9.69727 2.77344C8.82812 1.46484 7.34375 0.595703 5.53711 0.595703C2.37305 0.595703 0 3.03711 0 6.49414ZM1.57227 6.49414C1.57227 3.89648 3.25195 2.16797 5.51758 2.16797C7.35352 2.16797 8.4082 3.31055 9.0332 4.28711C9.29688 4.67773 9.46289 4.78516 9.69727 4.78516C9.93164 4.78516 10.0781 4.66797 10.3613 4.28711C11.0352 3.33008 12.0508 2.16797 13.877 2.16797C16.1426 2.16797 17.8223 3.89648 17.8223 6.49414C17.8223 10.127 13.9844 14.043 9.90234 16.7578C9.80469 16.8262 9.73633 16.875 9.69727 16.875C9.6582 16.875 9.58984 16.8262 9.50195 16.7578C5.41016 14.043 1.57227 10.127 1.57227 6.49414Z","fill-opacity":"0.85"}})}),M=[],T={},R=Object(f["a"])(T,z,M,!1,null,null,null),A=R.exports,Z=function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("path",{attrs:{d:"M9.69727 18.5254C9.90234 18.5254 10.1953 18.3887 10.4102 18.2617C15.9082 14.7461 19.3945 10.6543 19.3945 6.49414C19.3945 3.03711 17.0215 0.595703 13.9551 0.595703C12.0508 0.595703 10.5859 1.65039 9.69727 3.26172C8.82812 1.66016 7.34375 0.595703 5.43945 0.595703C2.37305 0.595703 0 3.03711 0 6.49414C0 10.6543 3.48633 14.7461 8.99414 18.2617C9.19922 18.3887 9.49219 18.5254 9.69727 18.5254Z","fill-opacity":"0.85"}})},H=[],K={},W=Object(f["a"])(K,Z,H,!1,null,null,null),q=W.exports,J=50,D={name:"Content",components:{IconSideBar:x,IconBase:w,IconHeart:A,IconHeartFilled:q},props:["base_name","album_friendly_name","sidebar_shown_pc"],data:function(){return{page_count:0,current_page_to_load:0,photo_count:0,photo_list:[],initial_scroll_height:0,response_load_new:!0,fav_content_cache:{},fav_page_cache:null,menu_more_is_shown:!1,current_zoom_scale:0}},computed:{album_common_prefix:function(){return"/all"===this.base_name?"get-photo-":"/recent"===this.base_name?"get-recent-photo-":"/fav"===this.base_name?"get-fav-photo-":this.base_name+"-get-photo-"},album_get_count_json_name:function(){return this.album_common_prefix+"count"},album_get_image_at_current_page_json_name:function(){return this.album_common_prefix+"page-"+String(this.current_page_to_load)}},watch:{base_name:function(){this.initialize()}},created:function(){},mounted:function(){var e=this;return Object(i["a"])(regeneratorRuntime.mark((function t(){return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:e.initialize();case 1:case"end":return t.stop()}}),t)})))()},methods:{raise_event_show_sidebar:function(e,t){this.$emit("should-show-sidebar",e,t)},raise_event_show_preview:function(e,t,n,a,o){this.$emit("preview-photo",e,t,n,a,o)},load_image:function(){var e=this;return Object(i["a"])(regeneratorRuntime.mark((function t(){var n,a,o;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:if(e.response_load_new){t.next=2;break}return t.abrupt("return");case 2:if(e.response_load_new=!1,setTimeout((function(){e.response_load_new=!0}),1e3),!(e.current_page_to_load>=e.page_count)){t.next=6;break}return t.abrupt("return");case 6:if(!e.album_get_count_json_name.startsWith("get-fav-photo-")){t.next=11;break}for(n=Math.min(e.photo_list.length+J,e.fav_page_cache.length),a=e.photo_list.length;a<n;a++)e.photo_list.push(e.fav_page_cache[a]);t.next=20;break;case 11:return t.t0=(o=e.photo_list).push,t.t1=o,t.t2=$["a"],t.next=16,_.get_secured_json(e.album_get_image_at_current_page_json_name);case 16:t.t3=t.sent,t.t4=(0,t.t2)(t.t3),t.t0.apply.call(t.t0,t.t1,t.t4),e.applyFavoriteWithPhotos();case 20:e.current_page_to_load++;case 21:case"end":return t.stop()}}),t)})))()},get_thumbnail_image:function(e,t){return"/api/album-cache/"+e+"/"+t},get_thumbnail_image_backgrouod_pos:function(e){if("undefined"==typeof e.faces)return"0px 0px";var t=e.faces;if(0==t.length)return"0px 0px";var n=t.map((function(e){return e[0]})).reduce((function(e,t){return e+t}),0)/t.length,a=t.map((function(e){return e[1]})).reduce((function(e,t){return e+t}),0)/t.length,o=t.map((function(e){return e[2]})).reduce((function(e,t){return e+t}),0)/t.length,r=t.map((function(e){return e[3]})).reduce((function(e,t){return e+t}),0)/t.length,i=n+o/2,s=a+r/2,c=e.w,l=e.h,u=e.w/e.h;if(u>1){var _=e.h/e.w,h=i/c,d=Math.max(0,h-_/2);return"".concat(100*d,"% 0%")}var p=s/l,m=p;return Math.max(0,p-u/2),"0% ".concat(100*m,"%")},initialize:function(){var e=this;return Object(i["a"])(regeneratorRuntime.mark((function t(){var n,a;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:if(""!==e.base_name){t.next=2;break}return t.abrupt("return");case 2:if(e.current_page_to_load=0,e.photo_list=[],e.response_load_new=!0,e.initial_scroll_height=0,e.photo_count=e.page_count=0,!e.album_get_count_json_name.startsWith("get-fav-photo-")){t.next=12;break}if(null==e.fav_page_cache||0==e.current_page_to_load)for(n in e.fav_page_cache=[],e.loadAllFavoriteItems(),e.fav_content_cache)for(a in e.fav_content_cache[n])e.fav_page_cache.push(e.fav_content_cache[n][a]);e.photo_count=e.fav_page_cache.length,t.next=15;break;case 12:return t.next=14,_.get_secured_json(e.album_get_count_json_name);case 14:e.photo_count=t.sent.count;case 15:e.page_count=Math.ceil(e.photo_count/J),e.page_count>0&&e.load_image();case 17:case"end":return t.stop()}}),t)})))()},handleScroll:function(e){0===this.initial_scroll_height&&(this.initial_scroll_height=e.srcElement.scrollHeight/10),e.srcElement.offsetHeight+e.srcElement.scrollTop>=e.srcElement.scrollHeight-this.initial_scroll_height&&this.load_image()},isFavorite:function(e){return e.fav},getFavoriteStorageKey:function(e){return"".concat(e.al,"/").concat(e.name)},getFavoriteLocalStorageKey:function(e){return"album_fav_".concat(e.al)},getFavoriteLocalStorageAllKeys:function(){for(var e=[],t=0,n=localStorage.length;t<n;++t){var a=localStorage.key(t);a.startsWith("album_fav_")&&e.push(a)}return e},loadAllFavoriteItems:function(){this.fav_content_cache={};for(var e=this.getFavoriteLocalStorageAllKeys(),t=0;t<e.length;t++)this.fav_content_cache[e[t]]=JSON.parse(localStorage.getItem(e[t]))},applyFavoriteWithPhotos:function(){this.loadAllFavoriteItems();for(var e=0;e<this.photo_list.length;e++){var t=this.getFavoriteStorageKey(this.photo_list[e]),n=this.getFavoriteLocalStorageKey(this.photo_list[e]);"undefined"!=typeof this.fav_content_cache[n]&&("undefined"!=typeof this.fav_content_cache[n][t]&&(this.photo_list[e].fav=!0))}this.$forceUpdate()},saveFavoriteState:function(e){var t=this.getFavoriteStorageKey(e),n=this.getFavoriteLocalStorageKey(e);"undefined"==typeof this.fav_content_cache[n]&&(this.fav_content_cache[n]={}),e.fav?this.fav_content_cache[n][t]=e:delete this.fav_content_cache[n][t];var a=window.localStorage;"undefined"!==typeof a?a.setItem(n,JSON.stringify(this.fav_content_cache[n])):alert("你的浏览器不支持Local Storage，无法使用此功能。")},switchFavState:function(e){e.fav=!e.fav,this.$forceUpdate(),this.saveFavoriteState(e)}}},G=D,U=(n("1dea"),Object(f["a"])(G,F,B,!1,null,"d9a801a4",null)),V=U.exports,Q=function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("div",{class:e.showNavBar?"preview-with-navbar":"preview-hidden-navbar",staticStyle:{width:"100%",height:"100%"}},[n("span",{staticStyle:{position:"absolute",top:"45%","text-align":"center",color:"#888",display:"block",width:"100%"}},[e._v("正在加载图片...")]),n("div",{staticClass:"preview-photo-base preview-bg",style:e.preview_cache_img_style}),n("div",{staticClass:"preview-photo-high-res preview-bg",style:e.preview_img_style}),n("div",{staticClass:"preview-mask",on:{click:function(){e.showNavBar=!e.showNavBar}}}),n("div",{directives:[{name:"show",rawName:"v-show",value:e.showNavBar,expression:"showNavBar"}],staticClass:"navbar",staticStyle:{width:"100% !important"}},[n("div",{staticClass:"nav-title"},[e._v(" "+e._s(e.photo_name)+" ")]),n("div",{staticClass:"left-button-group",on:{click:function(t){return e.raise_hide_preview()}}},[n("i",{staticClass:"larrow"}),n("span",{staticClass:"backtext"},[e._v(e._s(""===e.catalog_name?"相册列表":e.catalog_name))])]),n("div",{staticClass:"right-button-group"},[n("a",{attrs:{href:"javascript:void(0)"},on:{click:function(t){return e.downloadPhoto()}}},[e._v("下载")])])])])},X=[],Y=(n("ac1f"),n("5319"),n("8f6b"),{name:"Preview",props:["current_album_name","current_photo_filename","image_list","index","catalog_name","current_photo"],data:function(){return{showNavBar:!0,preview_img_style:{},preview_cache_img_style:{}}},computed:{photo_name:function(){return this.current_photo_filename.replace(/\.[a-z|A-Z|0-9]*$/g,"")},thumbnail_path:function(){return"/api/album-cache/".concat(this.current_album_name,"/").concat(this.current_photo_filename)},photo_path:function(){return"/api/album/".concat(this.current_album_name,"/").concat(this.current_photo_filename)}},methods:{raise_hide_preview:function(){this.$emit("hide-preview")},thumbnail_path_at_index:function(e){return"/api/album-cache/".concat(this.image_list[e].al,"/").concat(this.image_list[e].name)},photo_path_at_index:function(e){return"/api/album/".concat(this.image_list[e].al,"/").concat(this.image_list[e].name)},downloadPhoto:function(){window.open(this.photo_path)},getBackgroundSize:function(){var e=this.current_photo.h,t=this.current_photo.w,n=window.innerHeight,a=window.innerWidth,o=t/e,r=a/n,i=o-r,s="auto 100%",c="100% auto";return console.log(o,r),o>1?r>1?i>0?c:s:c:r>1?s:i>0?c:s}},watch:{current_photo:function(){this.preview_img_style={backgroundImage:"url('"+this.photo_path+"')",backgroundSize:this.getBackgroundSize()},this.preview_cache_img_style={backgroundImage:"url('"+this.thumbnail_path+"')",backgroundSize:this.getBackgroundSize()}}},mounted:function(){}}),ee=Y,te=Object(f["a"])(ee,Q,X,!1,null,"1346e270",null),ne=te.exports,ae=function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("div",{staticClass:"pwdi"},[n("div",{staticStyle:{position:"relative",height:"100%",width:"100%",margin:"0 0"}},[n("div",{directives:[{name:"show",rawName:"v-show",value:!0,expression:"true || password_dialog_shown"}],staticClass:"dialog"},[n("div",{staticClass:"title"},[e._v(" 相册 ")]),n("div",{staticClass:"ctnt"},[e.passwordErrorMsgShown?n("p",{staticStyle:{color:"red"}},[e._v("密码错误，请重新输入！")]):n("p",[e._v("请输入密码以访问相册。")]),n("input",{directives:[{name:"model",rawName:"v-model",value:e.passwordEntered,expression:"passwordEntered"}],ref:"pi",attrs:{type:"password",placeholder:"密码"},domProps:{value:e.passwordEntered},on:{keyup:function(t){return!t.type.indexOf("key")&&e._k(t.keyCode,"enter",13,t.key,"Enter")?null:e.submitPassword()},input:function(t){t.target.composing||(e.passwordEntered=t.target.value)}}}),n("div",{staticStyle:{"padding-top":"25px","text-align":"center"}},[n("button",{staticClass:"primary",staticStyle:{width:"100px"},attrs:{disabled:!e.password_dialog_shown},on:{click:function(t){return e.submitPassword()}}},[e._v("确定")])])])])])])},oe=[],re=(n("a9fa"),n("8237")),ie={name:"PasswordInput",data:function(){return{passwordErrorMsgShown:!1,passwordEntered:"",password_dialog_shown:!0,showInput:!0}},methods:{submitPassword:function(){var e=this;return Object(i["a"])(regeneratorRuntime.mark((function t(){return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:if(e.password_dialog_shown){t.next=2;break}return t.abrupt("return");case 2:if(console.log("submit password: ",re(e.passwordEntered)),""!==e.passwordEntered){t.next=5;break}return t.abrupt("return",e.$refs.pi.focus());case 5:e.password_dialog_shown=!1,e.$emit("submit-password",re(e.passwordEntered));case 7:case"end":return t.stop()}}),t)})))()},feedback:function(e){e||(this.password_dialog_shown=!0,this.passwordEntered="",this.passwordErrorMsgShown=!0)}},watch:{password_dialog_shown:function(){}},mounted:function(){this.$refs.pi.focus()}},se=ie,ce=Object(f["a"])(se,ae,oe,!1,null,"2e6cf5bf",null),le=ce.exports,ue=(n("8237"),{name:"App",components:{Sidebar:O,ContentView:V,Preview:ne,PasswordInput:le},data:function(){return{activeName:"beautiful-album",content_view_shown:!0,sidebar_shown_on_mobile_mode:!1,sidebar_shown_on_pc_mode:!0,password_input_shown:!1,preview_shown:!1,preview_filename:"",preview_imagelist:[],preview_index:0,preview_album_name:"",preview_current_obj:"",contentAlbumName:"",contentFriendlyName:""}},methods:{previewPhoto:function(e,t,n,a,o){this.preview_filename=e,this.preview_index=n,this.preview_imagelist=t,this.preview_album_name=a,this.preview_current_obj=o,this.preview_shown=!0},requirePassword:function(){var e=this;return Object(i["a"])(regeneratorRuntime.mark((function t(){return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:e.password_input_shown=!0;case 1:case"end":return t.stop()}}),t)})))()},checkPassword:function(e){var t=this;return Object(i["a"])(regeneratorRuntime.mark((function n(){return regeneratorRuntime.wrap((function(n){while(1)switch(n.prev=n.next){case 0:return window.miyuki_password=e,window.enabled_password=!0,n.prev=2,n.next=5,_.get_secured_json("get-album");case 5:localStorage.setItem("password",e),t.$refs.password_input.feedback(!0),t.password_input_shown=!1,t.initialize(),n.next=16;break;case 11:n.prev=11,n.t0=n["catch"](2),localStorage.removeItem("password"),t.requirePassword(),t.$refs.password_input.feedback(!1);case 16:case"end":return n.stop()}}),n,null,[[2,11]])})))()},initialize:function(){this.$refs.sidebar.getAlbumList(),this.contentAlbumName="/all",this.contentFriendlyName="图库"}},mounted:function(){var e=this;return Object(i["a"])(regeneratorRuntime.mark((function t(){var n;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return window.innerWidth<=500&&(e.sidebar_shown_on_mobile_mode=!0),t.next=3,_.get_json("password");case 3:n=t.sent,n=n.enabled,!0,n?null!==localStorage.getItem("password")?e.checkPassword(localStorage.getItem("password")):e.requirePassword():(window.enabled_password=!1,e.initialize());case 7:case"end":return t.stop()}}),t)})))()}}),_e=ue,he=(n("034f"),Object(f["a"])(_e,o,r,!1,null,null,null)),de=he.exports;a["a"].config.productionTip=!1,new a["a"]({render:function(e){return e(de)}}).$mount("#app")},"6c84":function(e,t,n){},"6d3e":function(e,t,n){},"7f5e":function(e,t,n){},"85ec":function(e,t,n){},"8e9e":function(e,t,n){},"8f6b":function(e,t,n){},"9b91":function(e,t,n){},a9fa:function(e,t,n){},bfe0:function(e,t,n){},daa8:function(e,t,n){"use strict";var a=n("0487"),o=n.n(a);o.a},eacf:function(e,t,n){},f33e:function(e,t,n){}});
//# sourceMappingURL=app.0c7e4d31.js.map